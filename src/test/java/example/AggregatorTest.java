package example;

import org.junit.Rule;
import org.junit.Test;

import org.neo4j.driver.v1.Config;
import org.neo4j.driver.v1.Driver;
import org.neo4j.driver.v1.GraphDatabase;
import org.neo4j.driver.v1.Session;
import org.neo4j.harness.junit.Neo4jRule;

import static org.hamcrest.CoreMatchers.equalTo;
import static org.junit.Assert.*;

public class AggregatorTest {
    @Rule
    public Neo4jRule neo4j = new Neo4jRule()
            .withFunction(Aggregator.class );

    @Test
    public void average() throws Throwable
    {
        // This is in a try-block, to make sure we close the driver after the test
        try( Driver driver = GraphDatabase
                .driver( neo4j.boltURI() , Config.build().withEncryptionLevel( Config.EncryptionLevel.NONE ).toConfig() ) )
        {
            Session session = driver.session();

            Double result = session.run(
                    "RETURN example.average(['a1:1, b1:1', 'a2:2, b2:2', 'a3:3, b3:3']) AS result")
                    .single().get("result").asDouble();
            assertThat( result, equalTo( 2.0 ) );
        }
    }

    @Test
    public void max() throws Throwable
    {
        // This is in a try-block, to make sure we close the driver after the test
        try( Driver driver = GraphDatabase
                .driver( neo4j.boltURI() , Config.build().withEncryptionLevel( Config.EncryptionLevel.NONE ).toConfig() ) )
        {
            Session session = driver.session();

            Double result = session.run(
                    "RETURN example.max([\"1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0\", \"1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0,1543345940:615148.0,1543346050:615148.0,1543346390:615148.0,1543346860:615148.0,1543346070:615148.0,1543346630:615148.0,1543345200:615140.0,1543345280:615148.0,1543345420:615148.0,1543346800:615148.0,1543346190:615148.0,1543346060:615148.0,1543346770:615148.0,1543346410:615148.0,1543345950:615148.0,1543345240:615140.0,1543345880:615148.0,1543346450:615148.0,1543346270:615148.0,1543345490:615148.0,1543345450:615148.0,1543346090:615148.0,1543345840:615148.0,1543345230:615140.0,1543345780:615148.0,1543345440:615148.0,1543346620:615148.0,1543345650:615148.0,1543346900:615148.0,1543345360:615148.0,1543345410:615148.0,1543346100:615148.0,1543346140:615148.0,1543346400:615148.0,1543346230:615148.0,1543346430:615148.0,1543345720:615148.0,1543345500:615148.0,1543345660:615148.0,1543346010:615148.0,1543345580:615148.0,1543346810:615148.0,1543345930:615148.0,1543346130:615148.0,1543345800:615148.0,1543345870:615148.0,1543346180:615148.0,1543346580:615148.0,1543346780:615148.0,1543346690:615148.0,1543345990:615148.0,1543345740:615148.0,1543346520:615148.0,1543345920:615148.0,1543346560:615148.0,1543346530:615148.0,1543346790:615148.0,1543346310:615148.0,1543346610:615148.0,1543346750:615148.0,1543345570:615148.0,1543345790:615148.0,1543345600:615148.0,1543345310:615148.0,1543345350:615148.0,1543345530:615148.0,1543345390:615148.0,1543346740:615148.0,1543346300:615148.0,1543346220:615148.0,1543346350:615148.0,1543346380:615148.0,1543345700:615148.0,1543346460:615148.0,1543346510:615148.0,1543345380:615148.0,1543345340:615148.0,1543346030:615148.0,1543345670:615148.0,1543345210:615140.0,1543345910:615148.0,1543346540:615148.0,1543345640:615148.0,1543346210:615148.0,1543346700:615148.0,1543346290:615148.0,1543346150:615148.0,1543345680:615148.0,1543346760:615148.0,1543346280:615148.0,1543346200:615148.0,1543345980:615148.0,1543345610:615148.0,1543345830:615148.0,1543346890:615148.0,1543345760:615148.0,1543345470:615148.0,1543346730:615148.0,1543346040:615148.0,1543346370:615148.0,1543345250:615144.0,1543346670:615148.0\"]) AS result")
                    .single().get("result").asDouble();
            System.out.println("result = " + result);
           // assertThat( result, equalTo( 3.0 ) );
        }
    }

    @Test
    public void min() throws Throwable
    {
        // This is in a try-block, to make sure we close the driver after the test
        try( Driver driver = GraphDatabase
                .driver( neo4j.boltURI() , Config.build().withEncryptionLevel( Config.EncryptionLevel.NONE ).toConfig() ) )
        {
            Session session = driver.session();

            Double result = session.run(
                    "RETURN example.min(['a1:1, b1:1', 'a2:2, b2:2', 'a3:3, b3:3']) AS result")
                    .single().get("result").asDouble();
            assertThat( result, equalTo( 1.0 ) );
        }
    }
}